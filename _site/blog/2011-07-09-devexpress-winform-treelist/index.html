<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>rubot</title>
    
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="/css/baseStyles.css">
  </head>
  <body>
    <section class="section is-paddingless-horizontal" style="padding-top: 0;">
      <div class="container grid">
        <a href="/index.html"><h1 class="title is-1">
          rubot
        </h1></a>
        <p class="subtitle">
          thoughts from a software engineer
        </p>
        <nav class="level">
          <div class="level-left">
            <p class="level-item"><a href="/posts">Posts</a></p>
            <p class="level-item"><a href="/about">About</a></p>
          </div>
          <div class="level-right">
            <p class="level-item"><a class="link" target="_blank" rel="noopener" aria-label="Github" href="https://github.com/fragosti"><i data-feather="github"></i></a></p>
            <p class="level-item"><a class="link" target="_blank" rel="noopener" aria-label="Github" href="https://github.com/fragosti"><i data-feather="twitter"></i></a></p>
          </div>
        </nav>
        <hr style="padding-top: 0; margin-top: 0;">

        <main id="skip">
          
<div class="section is-paddingless-horizontal" style="padding-top: 0; margin-top: 0;">
    <h1 class="title is-2">Using Devexpress Winforms Treelist Control</h1>
</div>

<div class="content is-medium">
  <p><img src="./jeremy-zero-Vu2R3PqstrU-unsplash.jpg" alt="Shows windows computer destop with a software installation window."></p>
<p>I have been using the DevExpress WinForms &amp; ASP.Net controls at work. I have been surprised by the many useful features that you get straight out of the box. I mostly work with the ASP.Net controls, but recently I have been using the DevExpress TreeList WinForm controls.</p>
<!--more-->
<p>I needed to and when the user clicks the third level it displays relevant information to the user.
One of the things that I found really interesting was that your business object can implement the IVirtualTreeListData interface, this will then allow you to create the hierarchical structure for your business objects and then you will be able to directly bind a list of these objects to the tree list. For my current project I did not want to implement this interface directly in my entities. I thought it would be better to define a class that only catered to the concerns related to the tree list and did not expose all the details of the entity. Below is the TreeNode class that implements the IVirtualTreeListData.</p>
<pre><code>public class TreeNode : TreeList.IVirtualTreeListData
{
 protected TreeNode parentNode;
 protected List childrenNodes = new List();
 protected string _name;
 protected int _id;&lt;/code&gt;
 
 public TreeNode (TreeNode parent, string name, int id)
 {
  this.parentNode = parent;
 
  _name = name;
  _id = id;
 
  if(this.parentNode != null)
  this.parentNode.childrenNodes.Add(this);
 } 
 
 public void VirtualTreeGetCellValue(VirtualTreeGetCellValueInfo info)
 {
  if (info.Column.AbsoluteIndex == 0)
   info.CellData = _name;
  else
   info.CellData = _id;
 }
 
 public void VirtualTreeGetChildNodes(VirtualTreeGetChildNodesInfo info)
 {
  info.Children = childrenNodes;
 }
 
 public void VirtualTreeSetCellValue(VirtualTreeSetCellValueInfo info)
 {
  if (info.Column.AbsoluteIndex == 0)
   _name = info.NewCellData.ToString();
  else
   _id = (int)info.NewCellData;
 }
}
</code></pre>
<p>Below is the method that populates the TreeNodes with data from your entities and binds to the treelist.</p>
<pre><code>private void SetupControls()
{
 //This sections sets up the tree list columns. I only display the fist column to the user. The second is used to  retrieve the additional information for the user.
 TreeListColumn col1 = new TreeListColumn();
 col1.Caption = &quot;Name&quot;;
 col1.VisibleIndex = 0;
 TreeListColumn col2 = new TreeListColumn();
 col2.Caption = &quot;Id&quot;;
 col2.VisibleIndex = 1;
 col2.Visible = false;
 treeList1.Columns.AddRange(new TreeListColumn[] { col1, col2 });
 //Here we create the root node for the treelist
 TreeNode datasource = new TreeNode(null, null, 0);
 //Iterate through the list of your entities to create the level 1, level 2 and level 3 nodes for
 tree list.
 foreach (TreeBusinessObject treenode in GetNodeObjects())
 {
  TreeNode node = new TreeNode(datasource, treenode.Node, 0);
  TreeNode subnode = new TreeNode(node, treenode.SubNode, 0);&lt;/code&gt;
 
  foreach (var item in treenode.GetChildSubNodes())
  {
   TreeNode childnode = new TreeNode(subnode, item, treenode.Id);
  }
 }
 //Bind to the tree list
 treeList1.DataSource = datasource;
}
</code></pre>
<p>I am also adding the code for my business object.</p>
<pre><code>public class TreeBusinessObject
{
 public int Id { get; set; }
 public string Node { get; set; }
 public string SubNode { get; set; }&lt;/code&gt;
 
 private List childSubNode;
 
 public TreeBusinessObject()
 {
  childSubNode = new List();
 }
 
 public TreeBusinessObject(int id)
 {
  Id = id;
  Node = String.Format(&quot;Node {0}&quot;, id.ToString());
  SubNode = String.Format(&quot;Sub Node {0}&quot;, id.ToString());
 
  childSubNode = new List();
  AddChildNode(String.Format(&quot;Child A1_{0}&quot;, id.ToString()));
  AddChildNode(String.Format(&quot;Child A2_{0}&quot;, id.ToString()));
  AddChildNode(String.Format(&quot;Child A3_{0}&quot;, id.ToString()));
 }
 
 public void AddChildNode(string childnode)
 {
  childSubNode.Add(childnode);
 }
 
 public List GetChildSubNodes()
 {
  return childSubNode;
 }
 
 public void RemoveChildNode(string childnode)
 {
  childSubNode.Remove(childnode);
 }
 
 public void ClearAllChildNodes()
 {
  childSubNode.Clear();
 }
}
</code></pre>
<h3>Conclusion</h3>
<p>I really liked that your business object can implement an interface and then directly bind a list of business objects to the tree list. Initially when I was working with the control I did not realise that there was a difference between selected nodes and focused nodes, but after using the control the difference is clear. The only thing I couldnâ€™t figure out was setting the state of the tree list i.e. whether is was expanded or collapsed.
For for more information about binding a treelist to your business objects refer to the DevExpress documentation.</p>

</div>


        

<nav class="pagination is-centered" role="navigation" aria-label="pagination">
  <a class="pagination-previous">Previous</a>
  <a class="pagination-next">Next</a>
</nav>        
        </main>
      </div>   
         
    </section>
  <footer class="footer is-white">
    <div class="content has-text-centered">
      <p>Copyright 2023</p>
    </div>
  </footer>
  <script>
    feather.replace();
  </script>
  </body>
</html>